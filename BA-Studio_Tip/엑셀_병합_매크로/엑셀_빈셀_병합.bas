Sub merge_empty_same()

    Dim rngAll As Range                                     '전체(A)ll 데이터 영역을 넣을 변수
    Dim rngC As Range                                       'A열 전체영역 각 셀(C)ell 을 넣을 변수
    Dim r As Long                                           '행(r)ow 증가에 사용할 변수
    Dim rowsCnt As Long                                     '전체데이터 마지막행 넣을 변수

    Application.ScreenUpdating = False                     '화면 업데이트 (일시)정지
    Application.DisplayAlerts = False                       '화면 경고 중지(셀병합시 경고 무시하기 위해)


' 문자열이 있는 셀과 같이 병합
'    With ActiveSheet.UsedRange                             '전체 사용영역에서
'        Set rngAll = .Offset(1).Resize(.Rows.Count - 1, 1) 'A열 데이터 영역만을 변수에 넣음
'    End With
    
'    For Each rngC In rngAll                                 '각 열의 각셀을 순환
'        If rngC = vbNullString Then                         '만약 각셀이 비어있(A열에 해당)
'            rngC.Offset(-1).Resize(2).Merge                 '윗셀과 셀병합
'        End If
'    Next rngC


'    With ActiveSheet.UsedRange                             '전체 사용영역에서
'        Set rngAll = .Offset(1).Resize(.Rows.Count - 1, 2) 'B열 데이터 영역만을 변수에 넣음
'    End With

'    For Each rngC In rngAll                                 '각 열의 각셀을 순환
'        If rngC = vbNullString Then                         '만약 각셀이 비어있(B열에 해당)
'            rngC.Offset(-1).Resize(2).Merge                 '윗셀과 셀병합
'        End If
'    Next rngC




' 아래는 빈칸만 머지
    rowsCnt = Cells(Rows.Count, 1).End(3).Row               '전체행의 마지막행을 변수에

' A열  밑에서 위로 진행
    For r = rowsCnt To 2 Step -1                            '제일 마지막행에서 한 행씩 줄이면서 반복
        If Cells(r, 1) = Cells(r + 1, 1) Then               '만약 각셀이 아래셀과 같으면(A열 해당)
            Cells(r, 1).Resize(2).Merge                     '(A열)두 셀을 셀병합
        End If
    Next r

'B열  밑에서 위로 진행
    For r = rowsCnt To 2 Step -1                            '제일 마지막행에서 한 행씩 줄이면서 반복
        If Cells(r, 2) = Cells(r + 1, 2) Then               '만약 각셀이 아래셀과 같으면(B열 해당)
            If Cells(r + 1, 1).Value <> "" Then             '왼쪽 A열의 값이 없을때만
            Else
                Cells(r, 2).Resize(2).Merge                     '(B열)두 셀을 셀병합
            End If
        End If
    Next r




'A열기준으로 B열 C열 병합  위에서 아래로 진행
    For r = 1 To rowsCnt Step 1                             '제일 마지막행에서 한 행씩 줄이면서 반복
        If Cells(r, 1).Value <> "" Then                     '현재 Cell 이 공백이 아니면 
            Cells(r, 1).Resize(,3).Merge                    'A열, B열, C열을 병합 
        End If
    Next r

'B열기준으로 C열 병합   위에서 아래로 진행
    For r = 1 To rowsCnt Step 1                             '제일 마지막행에서 한 행씩 줄이면서 반복
        If Cells(r, 2).Value <> "" Then                     '현재 Cell 이 공백이 아니면 
            Cells(r, 2).Resize(,2).Merge                    'A열, B열, C열을 병합 
        End If
    Next r


' 마지막 row , row + 1 일때 처리 넣기
'C열   아래서 위로 진행  If Cells(r, isColumn - 1).MergeCells = False Then          '왼쪽 셀(B열)이 병합되었는지 판별 
    isColumn = 3                                                   'C열
    For r = rowsCnt To 2 Step -1                                   '제일 마지막행에서 한 행씩 줄이면서 반복
        If Cells(r, isColumn) = Cells(r + 1, isColumn) Then        '만약 각셀이 아래셀과 같으면(A열 해당)
            If Cells(r + 1, isColumn - 2).Value = "" And Cells(r + 1, isColumn - 1).Value = "" Then   'A열, B열 공백일때만 
                Cells(r, isColumn).Resize(2).Merge                 '(A열)두 셀을 셀병합  병합이 안되어 있을때만 병합
            End If
        End If
    Next r


    
    Application.DisplayAlerts = True                        '화면 경고 복원

    Set rngAll = Nothing                                    '개체변수 초기화(메모리 비우기)

End Sub

