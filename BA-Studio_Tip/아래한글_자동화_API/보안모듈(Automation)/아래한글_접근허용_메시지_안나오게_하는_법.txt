
""" 아래한글 자동화를 위해 보안승인모듈을 PC에 등록하는 방법
python으로 아래한글 자동화를 하다보면 다음과 같이 보안승인 창이 계속 뜨게 됩니다.
매 파일을 열고 제어할 때마다 아래 그림의 "모두 허용(A)"를 눌러줘야 하죠 ㅠ
자동화 코드를 실행했음에도 매 파일마다 일일히 클릭을 해줘야 하는 아이러니한 상황이 펼쳐지게 됩니다.
여러 블로그를 찾고 시행착오를 겪은 결과 성공하였고 그 방법에 대해 공유하려합니다.
그래서 본 포스팅에선 한글과컴퓨터 홈페이지의 보안승인 모듈을 PC에 등록하여 이를 해결하는 포스팅을 진행하겠습니다 :)


1. 보안모듈 파일 저장
한글과컴퓨터 홈페이지 > 고객 지원 > 개발자료실 > 한/글 오토메이션용 보안승인모듈, 한/글 컨트롤용 보안승인모듈

이 중 오토메이션용의 zip 파일을 다운 받습니다 >  zip 파일 안의 모든 파일을 일부 디렉터리에 저장
파일명: 보안모듈(Automation).zip
C:\Program Files (x86)\Hnc\HwpAutomation\Modules\폴더를 생성하고 다운 받은 zip 파일 내부의 모든 파일을 옮깁니다.
FilePathCheckerModuleExample.dll


2. 레지스트리 등록
window 키 + R 을 누름 > regedit 입력 > 레지스티리 편집기 열림

HKEY_CURRENT_USER > HNC(또는 Hnc) > HwpAutomation > Modules 로 이동
* HNC가 없는 경우 Hnc 로 이동
* 내부에 HwpAutomation이 없는 경우 생성 : 상위 디렉터리(HNC 또는 Hnc) > 우클릭 > 새로 만들기 > 키(K) > HwpAutomation 입력
* 내부에 Modules가 없는 경우 생성 : 상위 디렉터리(HwpAutomation) > 우클릭 > 새로 만들기 > 키(K) > Modules 입력 
HwpAutomation > Moduels > 우측 공간에 우클릭 > 새로 만들기 > 문자열 값(S)
이름을 AutomationModule 로 설정 
우클릭 > 수정 > 값 데이터에 1번 단계에서 저장한 FilePathCheckerModuleExample.dll의 경로를 넣음 
※ "" 따옴표 들어가지 않도록 주의


3. 확인해보기
hwp=win32.gencache.EnsureDispatch("HWPFrame.HwpObject")
    
# 등록된 보안모듈을 가져오는 부분 
    #- 첫 번째 인자 : 그대로 사용("FilePathCheckDLL")
    #- 두 번째 인자 : 레지스트 편집기에 등록한 값 이름
hwp.RegisterModule("FilePathCheckDLL", "AutomationModule") 


hwp.Open(hwp_path,"HWP","forceopen:true")


코드에서 두 번째 줄 : 등록된 보안 모듈을 가져오는 부분

    첫 번째 인자 : 그대로 사용("FilePathCheckDLL")
    두 번째 인자 : 레지스트 편집기에 등록한 값 이름(본 포스팅에서는 "AutomationModule"로 설정했으므로 이것을 사용)

 
 
참조:
https://everyday-tech.tistory.com/entry/%EC%95%84%EB%9E%98%ED%95%9C%EA%B8%80-%EC%9E%90%EB%8F%99%ED%99%94-%EB%B3%B4%EC%95%88%EB%AA%A8%EB%93%88-%EB%93%B1%EB%A1%9D


C:\Program Files (x86)\Hnc\HwpAutomation\Modules\FilePathCheckerModuleExample.dll


"""
